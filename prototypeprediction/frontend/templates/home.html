<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Major Recommendation Prototype</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 700px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        h1 { 
            text-align: center; 
            color: #333;
        }
        form { 
            width: 100%;
        }
        .question { 
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .question label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        input[type="checkbox"], 
        input[type="radio"] { 
            margin-right: 8px;
            cursor: pointer;
        }
        .option-group {
            margin-left: 10px;
        }
        .option-group label {
            display: inline-block;
            font-weight: normal;
            margin: 5px 15px 5px 0;
            cursor: pointer;
        }
        select { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        button { 
            width: 100%;
            padding: 12px 20px; 
            background: #667eea; 
            color: white; 
            border: none; 
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            transition: background 0.3s;
        }
        button:hover {
            background: #764ba2;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        #results { 
            margin-top: 20px; 
            padding: 20px; 
            border: 2px solid #28a745;
            background: #d4edda;
            border-radius: 8px;
            display: none;
        }
        #results h2 {
            color: #155724;
            margin-top: 0;
        }
        #prediction {
            font-size: 18px;
            font-weight: bold;
            color: #155724;
        }
        #loading { 
            display: none; 
            color: #667eea;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
        }
        #error { 
            display: none; 
            color: #dc3545;
            background: #f8d7da;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéì Major Recommendation Tool</h1>
        <form id="recommendationForm">
            <!-- Question 1: Strongest Subjects -->
            <div class="question">
                <label>What subjects are you strongest in? (Choose 1‚Äì2)</label>
                <div class="option-group">
                    <label><input type="checkbox" name="strongest_subjects" value="Programming"> Programming</label><br>
                    <label><input type="checkbox" name="strongest_subjects" value="Mathematics"> Mathematics</label><br>
                    <label><input type="checkbox" name="strongest_subjects" value="Web Dev / Design"> Web Dev / Design</label><br>
                    <label><input type="checkbox" name="strongest_subjects" value="Networking / Hardware"> Networking / Hardware</label><br>
                    <label><input type="checkbox" name="strongest_subjects" value="Data Analysis"> Data Analysis</label><br>
                    <label><input type="checkbox" name="strongest_subjects" value="Business / Management"> Business / Management</label>
                </div>
            </div>

            <!-- Question 2: Preferred Task -->
            <div class="question">
                <label>What type of tasks do you enjoy the most? (Choose one)</label>
                <div class="option-group">
                    <label><input type="radio" name="preferred_task" value="Designing websites / interfaces" required> Designing websites / interfaces</label><br>
                    <label><input type="radio" name="preferred_task" value="Solving logic / programming problems" required> Solving logic / programming problems</label><br>
                    <label><input type="radio" name="preferred_task" value="Fixing computers / networks" required> Fixing computers / networks</label><br>
                    <label><input type="radio" name="preferred_task" value="Analyzing / organizing data" required> Analyzing / organizing data</label><br>
                    <label><input type="radio" name="preferred_task" value="Creating games / graphics" required> Creating games / graphics</label><br>
                    <label><input type="radio" name="preferred_task" value="Planning business / technical solutions" required> Planning business / technical solutions</label>
                </div>
            </div>

            <!-- Question 3: Programming Skills -->
            <div class="question">
                <label for="programming_skills">How do you rate your programming skills? (1‚Äì5)</label>
                <select name="programming_skills" id="programming_skills" required>
                    <option value="">Select</option>
                    <option value="1">1 - Beginner</option>
                    <option value="2">2 - Basic</option>
                    <option value="3">3 - Intermediate</option>
                    <option value="4">4 - Advanced</option>
                    <option value="5">5 - Expert</option>
                </select>
            </div>

            <!-- Question 4: Interest in Technology -->
            <div class="question">
                <label for="interest_in_technology">How do you rate your interest in technology? (1‚Äì5)</label>
                <select name="interest_in_technology" id="interest_in_technology" required>
                    <option value="">Select</option>
                    <option value="1">1 - Very Low</option>
                    <option value="2">2 - Low</option>
                    <option value="3">3 - Moderate</option>
                    <option value="4">4 - High</option>
                    <option value="5">5 - Very High</option>
                </select>
            </div>

            <!-- Question 5: Future Career Goal -->
            <div class="question">
                <label>What kind of career do you want in the future? (Choose one)</label>
                <div class="option-group">
                    <label><input type="radio" name="future_career_goal" value="Web/Mobile Developer" required> Web/Mobile Developer</label><br>
                    <label><input type="radio" name="future_career_goal" value="Software Engineer" required> Software Engineer</label><br>
                    <label><input type="radio" name="future_career_goal" value="Network Admin / Cybersecurity" required> Network Admin / Cybersecurity</label><br>
                    <label><input type="radio" name="future_career_goal" value="Data Analyst / DB Admin" required> Data Analyst / DB Admin</label><br>
                    <label><input type="radio" name="future_career_goal" value="Game Dev / Graphics" required> Game Dev / Graphics</label><br>
                    <label><input type="radio" name="future_career_goal" value="Business Analyst / IS" required> Business Analyst / IS</label>
                </div>
            </div>

            <!-- Question 6: Preferred Work Type -->
            <div class="question">
                <label>Do you prefer working with design, code, or hardware?</label>
                <div class="option-group">
                    <label><input type="radio" name="preferred_work_type" value="Design" required> Design</label><br>
                    <label><input type="radio" name="preferred_work_type" value="Code" required> Code</label><br>
                    <label><input type="radio" name="preferred_work_type" value="Hardware" required> Hardware</label>
                </div>
            </div>

            <!-- Question 7: Preferred Thinking Style -->
            <div class="question">
                <label>Do you prefer creative work or logical problem-solving?</label>
                <div class="option-group">
                    <label><input type="radio" name="preferred_thinking_style" value="Creative" required> Creative</label><br>
                    <label><input type="radio" name="preferred_thinking_style" value="Logical" required> Logical</label><br>
                    <label><input type="radio" name="preferred_thinking_style" value="Both" required> Both</label>
                </div>
            </div>

            <button type="submit" id="submitBtn">Get Recommendation</button>
        </form>

        <div id="loading">‚è≥ Loading prediction...</div>
        <div id="error"></div>
        <div id="results">
            <h2>‚úÖ Recommended Major:</h2>
            <p id="prediction"></p>
        </div>
    </div>

    <script>
        const form = document.getElementById('recommendationForm');
        const loader = document.getElementById('loading');
        const resultEl = document.getElementById('results');
        const predictionEl = document.getElementById('prediction');
        const errorEl = document.getElementById('error');
        const submitBtn = document.getElementById('submitBtn');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            resultEl.style.display = 'none';
            errorEl.style.display = 'none';
            loader.style.display = 'block';
            submitBtn.disabled = true;

            // Gather strongest_subjects (checkboxes) - must be 1-2 choices
            const checkedSubjects = Array.from(form.querySelectorAll('input[name="strongest_subjects"]:checked')).map(i => i.value);
            if (checkedSubjects.length === 0 || checkedSubjects.length > 2) {
                loader.style.display = 'none';
                submitBtn.disabled = false;
                errorEl.textContent = '‚ùå Please choose 1‚Äì2 strongest subjects.';
                errorEl.style.display = 'block';
                return;
            }

            // Build payload matching backend expectations
            const payload = {
                strongest_subjects: checkedSubjects,
                preferred_task: form.preferred_task.value,
                programming_skills: Number(form.programming_skills.value),
                interest_in_technology: Number(form.interest_in_technology.value),
                future_career_goal: form.future_career_goal.value,
                preferred_work_type: form.preferred_work_type.value,
                preferred_thinking_style: form.preferred_thinking_style.value
            };
            
            console.log('Sending payload:', payload);

            try {
            const res = await fetch('http://localhost:5000/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!res.ok) {
                const errData = await res.json();
                console.log('Server error:', errData);  // ADD THIS TOO
                throw new Error(errData.error || `Server error: ${res.statusText}`);
            }

                const data = await res.json();
                const major = data.major || data.recommended_major || 'Unknown';
                
                predictionEl.textContent = major;
                resultEl.style.display = 'block';
            } catch (err) {
                errorEl.textContent = `‚ùå Error: ${err.message}`;
                errorEl.style.display = 'block';
            } finally {
                loader.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>